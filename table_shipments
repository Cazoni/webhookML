<?php

function save_6_shipment($master_order_id) {
	require("../config/update_db.php");
	print_r("<br>".$master_order_id."<br>");
	$result = request_ME($master_order_id);
    $result = str_replace("'"," ",$result);
    $result = json_decode($result);
//	var_dump($result);
	$receiver_id = $result->receiver_id;
	$base_cost = $result->base_cost;
	$status_history_date_shipped = $result->status_history->date_shipped;
	$status_history_date_returned = $result->status_history->date_returned;
	$status_history_date_delivered = $result->status_history->date_delivered;
	$status_history_first_visit = $result->status_history->date_first_visit;
	$status_history_not_delivered = $result->status_history->date_not_delivered;
	$status_history_calcelled = $result->status_history->date_cancelled;
	$status_history_handling = $result->status_history->date_handling;
	$status_history_ready_to_ship = $result->status_history->date_ready_to_ship;
	$type = $result->type;
	$return_details = $result->return_details;
	$sender_id = $result->sender_id;
	$mode = $result->mode;
	$order_cost = $result->order_cost;
	$service_id = $result->service_id;
	$tracking_number = $result->tracking_number;
	$cost_components_loyal_discount = $result->cost_components->loyal_discount;
	$cost_components_special_discount = $result->cost_components->special_discount;
	$cost_components_compensation = $result->cost_components->compensation;
	$cost_components_gap_discount = $result->cost_components->gap_discount;
	$cost_components_ratio = $result->cost_components->ratio;
	$id = $result->id;
	$tracking_method = $result->tracking_method;
	$last_updated = $result->last_updated;
	$comments = $result->comments;
	$substatus = $result->substatus;
	$date_created = $result->date_created;
	$date_first_printed = $result->date_first_printed;
	$created_by = $result->created_by;
	$application_id = $result->application_id;
	$shipping_option_processing_time = $result->shipping_option->processing_time;
	$shipping_option_cost = $result->shipping_option->cost;
	$shipping_option_estimated_schedule_limit_date = $result->shipping_option->estimated_schedule_limit->date;
	$shipping_option_shipping_method_id = $result->shipping_option->shipping_method_id;
	$shipping_option_estimated_delivery_final_date = $result->shipping_option->estimated_delivery_final->date;
	$shipping_option_estimated_delivery_final_offset = $result->shipping_option->estimated_delivery_final->offset;
	$shipping_option_buffering_date = $result->shipping_option->buffering->date;
	$shipping_option_list_cost = $result->shipping_option->list_cost;
	$shipping_option_estimated_delivery_limit_date = $result->shipping_option->estimated_delivery_limit->date;
	$shipping_option_estimated_delivery_limit_offset = $result->shipping_option->estimated_delivery_limit->offset;
	$shipping_option_delivery_promise = $result->shipping_option->delivery_promise;
	$shipping_option_delivery_type = $result->shipping_option->delivery_type;
	$shipping_option_estimated_handling_limit_date = $result->shipping_option->estimated_handling_limit->date;
	$shipping_option_estimated_delivery_time_date = $result->shipping_option->estimated_delivery_time->date;
	$shipping_option_estimated_delivery_time_pay_before = $result->shipping_option->estimated_delivery_time->pay_before;
	$shipping_option_estimated_delivery_time_schedule = $result->shipping_option->estimated_delivery_time->schedule;
	$shipping_option_estimated_delivery_time_unit = $result->shipping_option->estimated_delivery_time->unit;
	$shipping_option_estimated_delivery_time_offset_date = $result->shipping_option->estimated_delivery_time->offset->date;
	$shipping_option_estimated_delivery_time_offset_shipping = $result->shipping_option->estimated_delivery_time->offset->shipping;
	$shipping_option_estimated_delivery_time_shipping = $result->shipping_option->estimated_delivery_time->shipping;
	$shipping_option_estimated_delivery_time_time_frame_from = $result->shipping_option->estimated_delivery_time->time_frame->from;
	$shipping_option_estimated_delivery_time_time_frame_to = $result->shipping_option->estimated_delivery_time->time_frame->to;
	$shipping_option_estimated_delivery_time_handling = $result->shipping_option->estimated_delivery_time->handling;
	$shipping_option_estimated_delivery_time_type = $result->shipping_option->estimated_delivery_time->type;
	$shipping_option_name = $result->shipping_option->name;
	$shipping_option_id = $result->shipping_option->id;
	$shipping_option_estimated_delivery_extended_date = $result->shipping_option->estimated_delivery_extended->date;
	$shipping_option_estimated_delivery_extended_offset = $result->shipping_option->estimated_delivery_extended->offset;
	$shipping_option_currency_id = $result->shipping_option->currency_id;
	$tags = json_encode($result->tags);
	$sender_adress_country_id = $result->sender_address->country->id;
	$sender_adress_country_name = $result->sender_address->country->name;
	$sender_adress_adress_line = $result->sender_address->address_line;
	$sender_adress_types = json_encode($result->sender_address->types);
	$sender_adress_scoring = $result->sender_address->scoring;
	$sender_adress_agency = $result->sender_address->agency;
	$sender_adress_city_id = $result->sender_address->city->id;
	$sender_adress_city_name = $result->sender_address->city->name;
	$sender_adress_geolocation_type = $result->sender_address->geolocation_type;
	$sender_adress_latitude = $result->sender_address->latitude;
	$sender_adress_municipality_id = $result->sender_address->municipality->id;
	$sender_adress_municipality_name = $result->sender_address->municipality->name;
	$sender_adress_location_id = $result->sender_address->location_id;
	$sender_adress_street_name = $result->sender_address->street_name;
	$sender_adress_zip_code = $result->sender_address->zip_code;
	$sender_adress_geolocation_source = $result->sender_address->geolocation_source;
	$sender_adress_instersection = $result->sender_address->instersection;
	$sender_adress_street_number = $result->sender_address->street_number;
	$sender_adress_comment = $result->sender_address->comment;
	$sender_adress_id = $result->sender_address->id;
	$sender_adress_state_id = $result->sender_address->state->id;
	$sender_adress_state_name = $result->sender_address->state->name;
	$sender_adress_neighborhood_id = $result->sender_address->neighborhood->id;
	$sender_adress_neighborhood_name = $result->sender_address->neighborhood->name;
	$sender_adress_geolocation_last_update = $result->sender_address->geolocation_last_update;
	$sender_adress_longitude = $result->sender_address->longitude;
	$sibling_reason = $result->sibling->reason;
	$sibling_sibling_id = $result->sibling->sibling_id;
	$sibling_description = $result->sibling->description;
	$sibling_source = $result->sibling->source;
	$sibling_date_created = $result->sibling->date_created;
	$sibling_last_updated = $result->sibling->last_updated;
	$return_tracking_number = $result->return_tracking_number;
	$site_id = $result->site_id;
	$carrier_info = $result->carrier_info;
	$market_place = $result->market_place;
	$receiver_adress_country_id = $result->receiver_address->country->id;
	$receiver_adress_country_name = $result->receiver_address->country->name;
	$receiver_adress_adress_line = $result->receiver_address->address_line;
	$receiver_adress_types = json_encode($result->receiver_address->types);
	$receiver_adress_scoring = $result->receiver_address->scoring;
	$receiver_adress_agency = json_encode($result->receiver_address->agency);
	$receiver_adress_city_id = $result->receiver_address->city->id;
	$receiver_adress_city_name = $result->receiver_address->city->name;
	$receiver_adress_geolocation_type = $result->receiver_address->geolocation_type;
	$receiver_adress_latitude = $result->receiver_address->latitude;
	$receiver_adress_municipality_id = $result->receiver_address->municipality->id;
	$receiver_adress_municipality_name = $result->receiver_address->municipality->name;
	$receiver_adress_location_id = $result->receiver_address->location_id;
	$receiver_adress_street_name = $result->receiver_address->street_name;
	$receiver_adress_zip_code = $result->receiver_address->zip_code;
	$receiver_adress_geolocation_source = $result->receiver_address->geolocation_source;
	$receiver_adress_delivery_preference = $result->receiver_address->delivery_preference;
	$receiver_adress_instersection = $result->receiver_address->instersection;
	$receiver_adress_street_number = $result->receiver_address->street_number;
	$receiver_adress_receiver_name = $result->receiver_address->receiver_name;
	$receiver_adress_comment = $result->receiver_address->comment;
	$receiver_adress_id = $result->receiver_address->id;
	$receiver_adress_state_id = $result->receiver_address->state->id;
	$receiver_adress_state_name = $result->receiver_address->state->name;
	$receiver_adress_neighborhood_id = $result->receiver_address->neighborhood->id;
	$receiver_adress_neighborhood_name = $result->receiver_address->neighborhood->name;
	$receiver_adress_geolocation_last_updated = $result->receiver_address->geolocation_last_updated;
	$receiver_adress_receiver_phone = $result->receiver_address->receiver_phone;
	$receiver_adress_longitude = $result->receiver_address->longitude;
	$order_id = $result->order_id;
	$status = $result->status;
	$logistic_type = $result->logistic_type;

	$_query = "INSERT INTO 6_shipment (master_order_id,receiver_id,base_cost,status_history_date_shipped,status_history_date_returned,status_history_date_delivered,status_history_first_visit,status_history_not_delivered,status_history_calcelled,status_history_handling,status_history_ready_to_ship,type,return_details,sender_id,mode,order_cost,service_id,tracking_number,cost_components_loyal_discount,cost_components_special_discount,cost_components_compensation,cost_components_gap_discount,cost_components_ratio,id,tracking_method,last_updated,comments,substatus,date_created,date_first_printed,created_by,application_id,shipping_option_processing_time,shipping_option_cost,shipping_option_estimated_schedule_limit_date,shipping_option_shipping_method_id,shipping_option_estimated_delivery_final_date,shipping_option_estimated_delivery_final_offset,shipping_option_buffering_date,shipping_option_list_cost,shipping_option_estimated_delivery_limit_date,shipping_option_estimated_delivery_limit_offset,shipping_option_delivery_promise,shipping_option_delivery_type,shipping_option_estimated_handling_limit_date,shipping_option_estimated_delivery_time_date,shipping_option_estimated_delivery_time_pay_before,shipping_option_estimated_delivery_time_schedule,shipping_option_estimated_delivery_time_unit,shipping_option_estimated_delivery_time_offset_date,shipping_option_estimated_delivery_time_offset_shipping,shipping_option_estimated_delivery_time_shipping,shipping_option_estimated_delivery_time_time_frame_from,shipping_option_estimated_delivery_time_time_frame_to,shipping_option_estimated_delivery_time_handling,shipping_option_estimated_delivery_time_type,shipping_option_name,shipping_option_id,shipping_option_estimated_delivery_extended_date,shipping_option_estimated_delivery_extended_offset,shipping_option_currency_id,tags,sender_adress_country_id,sender_adress_country_name,sender_adress_adress_line,sender_adress_types,sender_adress_scoring,sender_adress_agency,sender_adress_city_id,sender_adress_city_name,sender_adress_geolocation_type,sender_adress_latitude,sender_adress_municipality_id,sender_adress_municipality_name,sender_adress_location_id,sender_adress_street_name,sender_adress_zip_code,sender_adress_geolocation_source,sender_adress_instersection,sender_adress_street_number,sender_adress_comment,sender_adress_id,sender_adress_state_id,sender_adress_state_name,sender_adress_neighborhood_id,sender_adress_neighborhood_name,sender_adress_geolocation_last_update,sender_adress_longitude,sibling_reason,sibling_sibling_id,sibling_description,sibling_source,sibling_date_created,sibling_last_updated,return_tracking_number,site_id,carrier_info,market_place,receiver_adress_country_id,receiver_adress_country_name,receiver_adress_adress_line,receiver_adress_types,receiver_adress_scoring,receiver_adress_agency,receiver_adress_city_id,receiver_adress_city_name,receiver_adress_geolocation_type,receiver_adress_latitude,receiver_adress_municipality_id,receiver_adress_municipality_name,receiver_adress_location_id,receiver_adress_street_name,receiver_adress_zip_code,receiver_adress_geolocation_source,receiver_adress_delivery_preference,receiver_adress_instersection,receiver_adress_street_number,receiver_adress_receiver_name,receiver_adress_comment,receiver_adress_id,receiver_adress_state_id,receiver_adress_state_name,receiver_adress_neighborhood_id,receiver_adress_neighborhood_name,receiver_adress_geolocation_last_updated,receiver_adress_receiver_phone,receiver_adress_longitude,order_id,status,logistic_type) VALUE ('$master_order_id','$receiver_id','$base_cost','$status_history_date_shipped','$status_history_date_returned','$status_history_date_delivered','$status_history_first_visit','$status_history_not_delivered','$status_history_calcelled','$status_history_handling','$status_history_ready_to_ship','$type','$return_details','$sender_id','$mode','$order_cost','$service_id','$tracking_number','$cost_components_loyal_discount','$cost_components_special_discount','$cost_components_compensation','$cost_components_gap_discount','$cost_components_ratio','$id','$tracking_method','$last_updated','$comments','$substatus','$date_created','$date_first_printed','$created_by','$application_id','$shipping_option_processing_time','$shipping_option_cost','$shipping_option_estimated_schedule_limit_date','$shipping_option_shipping_method_id','$shipping_option_estimated_delivery_final_date','$shipping_option_estimated_delivery_final_offset','$shipping_option_buffering_date','$shipping_option_list_cost','$shipping_option_estimated_delivery_limit_date','$shipping_option_estimated_delivery_limit_offset','$shipping_option_delivery_promise','$shipping_option_delivery_type','$shipping_option_estimated_handling_limit_date','$shipping_option_estimated_delivery_time_date','$shipping_option_estimated_delivery_time_pay_before','$shipping_option_estimated_delivery_time_schedule','$shipping_option_estimated_delivery_time_unit','$shipping_option_estimated_delivery_time_offset_date','$shipping_option_estimated_delivery_time_offset_shipping','$shipping_option_estimated_delivery_time_shipping','$shipping_option_estimated_delivery_time_time_frame_from','$shipping_option_estimated_delivery_time_time_frame_to','$shipping_option_estimated_delivery_time_handling','$shipping_option_estimated_delivery_time_type','$shipping_option_name','$shipping_option_id','$shipping_option_estimated_delivery_extended_date','$shipping_option_estimated_delivery_extended_offset','$shipping_option_currency_id','$tags','$sender_adress_country_id','$sender_adress_country_name','$sender_adress_adress_line','$sender_adress_types','$sender_adress_scoring','$sender_adress_agency','$sender_adress_city_id','$sender_adress_city_name','$sender_adress_geolocation_type','$sender_adress_latitude','$sender_adress_municipality_id','$sender_adress_municipality_name','$sender_adress_location_id','$sender_adress_street_name','$sender_adress_zip_code','$sender_adress_geolocation_source','$sender_adress_instersection','$sender_adress_street_number','$sender_adress_comment','$sender_adress_id','$sender_adress_state_id','$sender_adress_state_name','$sender_adress_neighborhood_id','$sender_adress_neighborhood_name','$sender_adress_geolocation_last_update','$sender_adress_longitude','$sibling_reason','$sibling_sibling_id','$sibling_description','$sibling_source','$sibling_date_created','$sibling_last_updated','$return_tracking_number','$site_id','$carrier_info','$market_place','$receiver_adress_country_id','$receiver_adress_country_name','$receiver_adress_adress_line','$receiver_adress_types','$receiver_adress_scoring','$receiver_adress_agency','$receiver_adress_city_id','$receiver_adress_city_name','$receiver_adress_geolocation_type','$receiver_adress_latitude','$receiver_adress_municipality_id','$receiver_adress_municipality_name','$receiver_adress_location_id','$receiver_adress_street_name','$receiver_adress_zip_code','$receiver_adress_geolocation_source','$receiver_adress_delivery_preference','$receiver_adress_instersection','$receiver_adress_street_number','$receiver_adress_receiver_name','$receiver_adress_comment','$receiver_adress_id','$receiver_adress_state_id','$receiver_adress_state_name','$receiver_adress_neighborhood_id','$receiver_adress_neighborhood_name','$receiver_adress_geolocation_last_updated','$receiver_adress_receiver_phone','$receiver_adress_longitude','$order_id','$status','$logistic_type')";
	mysqli_query($_conexao, $_query) or print_r(mysqli_error($_conexao));

	save_7_substatus_history($result, $master_order_id);
	save_8_shipping_items($result, $master_order_id);
}

?>
